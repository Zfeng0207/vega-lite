{
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "width": 2200,
  "height": 900,
  "title": {
    "text": "Malaysia Participation Rate by State and Sex (2019â€“2022)",
    "fontSize": 22,
    "anchor": "start",
    "fontWeight": "bold"
  },
  "data": {
    "url": "https://raw.githubusercontent.com/Zfeng0207/vega-lite/refs/heads/main/data/lfs_state_sex_cleaned.csv",
    "format": {"type": "csv"}
  },
  "transform": [
    {"calculate": "toNumber(datum.year)", "as": "year"},
    {"calculate": "toNumber(datum.p_rate)", "as": "p_rate"},
    {"filter": "datum.sex == 'male' || datum.sex == 'female' || datum.sex == 'both'"},
    {"filter": "datum.year == year_select"}
  ],
  "params": [
    {
      "name": "year_select",
      "value": 2022,
      "bind": {
        "input": "range",
        "min": 2019,
        "max": 2022,
        "step": 1,
        "name": "Year: "
      }
    }
  ],
  "facet": {
    "column": {
      "field": "sex",
      "title": null,
      "sort": ["female", "male", "both"]
    },
    "spacing": 40
  },
  "spec": {
    "mark": {"type": "bar", "cornerRadius": 3},
    "encoding": {
      "y": {
        "field": "state",
        "type": "ordinal",
        "sort": {"field": "p_rate", "order": "descending"},
        "title": "State",
        "axis": {
          "labelLimit": 250,
          "labelFontSize": 15,
          "titleFontSize": 16
        }
      },
      "x": {
        "field": "p_rate",
        "type": "quantitative",
        "title": "Participation Rate (%)",
        "scale": {"domain": [0, 100]},
        "axis": {
          "tickCount": 21,
          "values": [0, 5, 10, 15, 20, 25, 30, 35, 40, 45,
            50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100],
          "labelFontSize": 14,
          "titleFontSize": 16
        }
      },
      "color": {
        "field": "sex",
        "type": "nominal",
        "scale": {
          "domain": ["female", "male", "both"],
          "range": ["#377eb8", "#ff7f0e", "#7f7f7f"]
        },
        "legend": null
      },
      "tooltip": [
        {"field": "state", "title": "State"},
        {"field": "sex", "title": "Sex"},
        {"field": "p_rate", "title": "Participation Rate (%)", "format": ".1f"},
        {"field": "year", "title": "Year"}
      ]
    }
  },
  "resolve": {"scale": {"y": "independent"}},
  "config": {
    "axis": {
      "labelFontSize": 14,
      "titleFontSize": 15,
      "labelLimit": 250
    },
    "view": {"stroke": null},
    "title": {"fontSize": 22, "anchor": "start"}
  }
}
